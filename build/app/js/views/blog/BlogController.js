/*! Global-Forest-Watch-Fires Tue Jul 22 2014 16:30:35 */
define(["dojo/dom","dijit/registry","modules/HashController","esri/urlUtils","views/map/MapConfig","modules/EventsController","views/blog/BlogModel","dojo/Deferred","dojo/_base/array"],function(a,b,c,d,e,f,g,h,i){var j={},k=!1,l="blogView",m={viewId:l,viewName:"blog"};return j.addConfigurations=function(){var a=e.proxies,b=document.location.href,c="/proxy/proxy.ashx";for(var d in a)0===b.indexOf(d)&&(c=a[d]);esri.config.defaults.io.proxyUrl=c},j.init=function(){j.addConfigurations();return k?void f.switchToView(m):(k=!0,void require(["dojo/text!views/blog/blog.html"],function(b){var c=j.loadFeed(esri.config.defaults.io.proxyUrl);c.then(function(c){var d=JSON.parse(c);j.addPosts(d),a.byId(l).innerHTML=b,f.switchToView(m),g.applyBindings(l)},function(){console.log("There was an error in binding")})}))},j.loadFeed=function(a){var b=new h;return require(["views/blog/BlogLoader"],function(c){var d=c.load_feed(a);d.then(function(a){b.resolve(a)},function(){console.dir("error")})}),b.promise},j.addPosts=function(a){console.log(a),a.articles.forEach(function(a){a.getAuthors=function(){var a=this.author.split(","),b=[];return i.forEach(a,function(c,d){if(0==d&&2!=a.length)b.push("by"),b.push(c.substring(3,c.length));else if(2==a.length&&0==d){var e=c.split("-");b.push("by"),b.push(e[0].substring(3,c.length)),b.push(e[1].trim()+a[d+1])}else if(d==a.length-2){var e=a[d].split("and");b.push(e[0].trim()),b.push("and");var f=e[1].split("-");b.push(f[0].trim()),b.push(f[1]+a[d+1])}else d==a.length-1||b.push(c.trim())}),b}}),g.vm.blogPost.push(a)},j});
/*! Global-Forest-Watch-Fires Thu Dec 11 2014 15:29:32 */
define(["dojo/dom","dijit/registry","modules/HashController","esri/urlUtils","views/map/MapConfig","modules/EventsController","views/blog/BlogModel","dojo/Deferred","dojo/_base/array"],function(a,b,c,d,e,f,g,h,i){var j={},k=!1,l="blogView",m={viewId:l,viewName:"blog"};return j.addConfigurations=function(){var a=e.proxies,b=document.location.href,c="/proxy/proxy.ashx";for(var d in a)0===b.indexOf(d)&&(c=a[d]);esri.config.defaults.io.proxyUrl=c,esri.config.defaults.io.corsEnabledServers.push("http://gis-potico.wri.org"),esri.config.defaults.io.corsEnabledServers.push("http://175.41.139.43")},j.init=function(){j.addConfigurations();return k?void f.switchToView(m):(k=!0,void require(["dojo/text!views/blog/blog.html"],function(b){var c=j.loadFeed(esri.config.defaults.io.proxyUrl);c.then(function(c){var d=JSON.parse(c);j.addPosts(d),a.byId(l).innerHTML=b,f.switchToView(m),g.applyBindings(l)},function(){console.log("There was an error in binding")})}))},j.loadFeed=function(a){var b=new h;return require(["views/blog/BlogLoader"],function(c){var d=c.load_feed(a);d.then(function(a){b.resolve(a)},function(){console.dir("error")})}),b.promise},j.addPosts=function(a){console.log(a),a.articles.forEach(function(a){a.getAuthors=function(){var a=this.author.split(","),b=[],c=!1;return a[a.length-2]=a[a.length-2]+a[a.length-1],a.pop(),i.forEach(a,function(d,e){try{if(!c)if(null!==d.match("by")&&null===d.match("-")){var f=d.split("by");b.push("by"),b.push(f[1].trim())}else if(null!==d.match("by")&&null!==d.match("-")){var g=d.split("-");b.push("by"),b.push(g[0].split("by")[1].trim()),b.push(g[1].trim()),c=!0}else if(null!==d.match("and")&&null!==d.match("-")){var h=d.split("and");i.forEach(h,function(a){if(null===a.match("-"))b.push(a.trim());else{var d=a.split("-");b.push("and"),b.push(d[0].trim()),b.push(d[1].trim()),c=!0}})}else if(null===d.match("and")&&null!==d.match("-")&&e===a.length-1){var j=a[a.length-2].split("and"),k=d.split("-");b.pop(),b.pop(),b.pop(),b.push(j[0].trim()),b.push("and"),b.push(j[1].trim()+", "+k[0].trim()),b.push(k[1].trim()),c=!0}else if(null!==d.match("and")){var h=d.split("and");b.push(h[0].trim()),b.push("and"),b.push(h[1].trim())}else if(null!==d.match("-")){var l=d.split("-");b.push(l[0].trim()),b.push(l[1].trim()),c=!0}else b.push(d.trim())}catch(m){console.log(m)}}),b}}),g.vm.blogPost.push(a)},j});
define(["dojo/hash","dojo/topic","dojo/_base/lang","dojo/io-query","main/Config","dojo/_base/array","modules/EventsController"],function(e,o,t,r,n,i,a){var l=window.location.href,s={},u={};s.newState={};var c=t.clone(n.defaultState);console.log(c);for(k in c)c[k]="";return u=c,s.init=function(){var e,t=this,a=2==l.split("#").length&&l.split("#")[1].length>1;if(e=a?r.queryToObject(l.split("#")[1]):n.defaultState,a){var s=e.v&&i.indexOf(n.validViews,e.v)>-1;s?e.dirty?delete e.dirty:e.dirty="true":e=n.defaultState}o.subscribe("/dojo/hashchange",function(e){var o=r.queryToObject(e),n=u;t.handleHashChange(o,n)}),t.updateHash(e),require(["views/footer/FooterController","views/header/HeaderController"],function(e,o){e.init(),o.init()})},s.handleHashChange=function(e,o){var t=this;s.newState=e;var r=o.v!=e.v,n="map"==e.v,i=o.x!=e.x||o.y!=e.y||o.y!=e.y;r&&t.changeView(e.v,o.v),n&&i&&a.centerChange(e),u=e},s.updateHash=function(o){var n=t.clone(u);t.mixin(n,o),require(["views/header/HeaderModel","views/footer/FooterModel"],function(e,o){e.vm.appState(n),o.vm.appState(n)});var i=r.objectToQuery(n);console.log(i),e(i)},s.changeView=function(e){var o={v:e};switch(console.log(e),e){case"home":require(["views/home/HomeController"],function(e){e.init(o)});break;case"map":require(["views/map/MapController"],function(e){e.init(o)});break;case"blog":require(["views/blog/BlogController"],function(e){e.init(o)});break;case"about":require(["views/about/AboutController"],function(e){e.init(o)});break;case"data":require(["views/data/DataController"],function(e){e.init(o)});break;case"story":require(["views/story/StoryController"],function(e){e.init(o)})}},s.getHash=function(){return r.queryToObject(e())},s});
define(["dojo/hash","dojo/topic","dojo/_base/lang","dojo/io-query","main/Config","dojo/_base/array","modules/EventsController","dojo/dom-style"],function(e,o,t,n,r,a,i,l){var s={},c={};s.newState={},console.log(window.location.href);var u=t.clone(r.defaultState);console.log(u);for(k in u)u[k]="";return c=u,s.init=function(){var e,t=this,i=window.location.href;console.log(i);var l=2==i.split("#").length&&i.split("#")[1].length>1;if(e=l?n.queryToObject(i.split("#")[1]):r.defaultState,l){var s=e.v&&a.indexOf(r.validViews,e.v)>-1;s?e.dirty?delete e.dirty:e.dirty="true":e=r.defaultState}o.subscribe("/dojo/hashchange",function(e){var o=n.queryToObject(e),r=c;t.handleHashChange(o,r)}),t.updateHash(e),require(["views/footer/FooterController","views/header/HeaderController"],function(e,o){o.init(),e.init()})},s.handleHashChange=function(e,o){var t=this;s.newState=e;var n=o.v!=e.v,r="map"==e.v,a=o.x!=e.x||o.y!=e.y||o.y!=e.y;n&&t.changeView(e.v,o.v),r&&a&&i.centerChange(e),c=e},s.updateHash=function(o){var r=t.clone(c);t.mixin(r,o),require(["views/header/HeaderModel","views/footer/FooterModel"],function(e,o){o.vm.appState(r),e.vm.appState(r)});var a=n.objectToQuery(r);console.log("newHashStr",a),e(a)},s.changeView=function(e){var o={v:e};switch("map"===e?l.set("app-footer","display","none"):l.set("app-footer","display","block"),e){case"home":require(["views/home/HomeController"],function(e){e.init(o)});break;case"map":require(["views/map/MapController"],function(e){e.init(o)});break;case"blog":require(["views/blog/BlogController"],function(e){e.init(o)});break;case"about":require(["views/about/AboutController"],function(e){e.init(o)});break;case"data":require(["views/data/DataController"],function(e){e.init(o)});break;case"story":require(["views/story/StoryController"],function(e){e.init(o)})}},s.getHash=function(){return n.queryToObject(e())},s});
define(["knockout","main/Config","views/story/StoryConfig","dojo/dom","dojo/_base/array","dojo/topic"],function(e,t,o,a,r,n){var i={};i.vm={};var s=i.vm;return s.headerTitle=e.observable(t.headerTitle),s.newStoryTitle=e.observable(t.newStory.title),s.storiesURL=o.storiesURL,s.localToken=o.localToken,s.stagingToken=o.stagingToken,s.productionToken=o.productionToken,s.addButtonLabel="Add Point",s.removeButtonLabel="Remove Point",s.storyTitleData=e.observable(),s.pointGeom=e.observable(),s.storyLocationData=e.observable(),s.dateObserv=e.observable(),s.storyDetailsData=e.observable(),s.storyVideoData=e.observable(),s.storyMediaData=e.observable(),s.storyNameData=e.observable(),s.storyEmailData=e.observable(),s.showBasemapGallery=e.observable(!1),s.stopSubmissionText="Wait! Both a Title and a valid email are required to submit your story.",s.formInvalidText="The email and/or the video url you provided is invalid.",s.noMapPoint="Please place a point on the map to represent your story!",s.submitSuccess="Your story was successfully submitted! You will now be redirected to the map to view your submission.",s.submitFailure="An error occured during the submission process.",s.attachSuccess="The attachment you selected was successfully added to the Story!",s.attachFailure="The attachment you selected could not be added to the Story",s.inputFilesSelector=e.observableArray([{display:!0}]),s.mediaListData=function(e,t){return t&&$(t.target.nextSibling.nextSibling).append(t.currentTarget.files[0].name),t},s.linkClick=function(e){n.publish("toggleStoryNavList",e)},s.datePicker=function(){var e=(jQuery("#storyDateInput").datepicker({minDate:new Date(2013,0,1),maxDate:"+0M +0D",onSelect:function(e){return s.dateObserv(e),e}}),new Date),t=e.getDate(),o=e.getMonth()+1,a=e.getFullYear(),r=o+"/"+t+"/"+a;return r},s.uploadStory=function(e,t){require(["views/story/StoryController"],function(o){o.handleUpload(e,t)})},s.mediaChange=function(e,t){require(["views/story/StoryController"],function(o){o.handleFileChange(e,t)})},s.attachmentRemove=function(e,t){require(["views/story/StoryController"],function(o){o.handleAttachmentRemove(e,t)})},s.mouseoverFile=function(e,t){$(t.target).children("img").remove(),$(t.target).append('<img id="theImg" src="app/images/redX.png" />')},s.mouseoutFile=function(e,t){$(t.target).children("img").remove()},i.get=function(e){return"model"===e?i.vm:i.vm[e]()},i.set=function(e,t){i.vm[e](t)},i.getVM=function(){return s},i.applyBindings=function(){e.applyBindings(s,a.byId("storyInnerContainer"))},i});
define(["dojo/on","esri/Color","esri/graphic","utils/Helper","dojo/_base/array","esri/toolbars/draw","views/map/MapConfig","views/map/MapModel","esri/geometry/Polygon","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol"],function(e,a,r,t,o,i,n,s,c,l,d){"use strict";var u,m,w=!1,b=new l(l.STYLE_SOLID,new d(d.STYLE_SOLID,new a([255,0,0]),2),new a([103,200,255,0])),p={init:function(a){var r=this;u=a,m=new i(a),m.on("draw-end",this.drawComplete.bind(this)),e(document.getElementById("drawFeatures"),"click",function(){w?r.deactivateToolbar():r.activateToolbar()})},drawComplete:function(e){if(this.deactivateToolbar(),e.geometry){var a,o,i=n.defaultGraphicsLayerUniqueId,l=n.defaultGraphicsLayerLabel,d=u.graphics,m=t.nextAvailableGraphicId(d,i),w={};w[i]=m,w[l]=["Custom Drawn Feature -",m].join(" "),o=new c(e.geometry),a=new r(o,b,w),d.add(a),s.vm.customFeaturesArray().push(a)}},activateToolbar:function(){m.activate(i.FREEHAND_POLYGON),w=!0,$("#drawFeatures").css("background-color","#e7002f")},deactivateToolbar:function(){m.deactivate(),w=!1,$("#drawFeatures").css("background-color","#444")},isActive:function(){return w}};return p});
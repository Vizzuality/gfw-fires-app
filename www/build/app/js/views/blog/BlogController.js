define(["dojo/dom","dijit/registry","modules/HashController","esri/urlUtils","views/map/MapConfig","modules/EventsController","views/blog/BlogModel","dojo/Deferred","dojo/_base/array","utils/Helper"],function(o,i,e,r,t,n,l,s,a,u){var h={},p=!1,d="blogView",c={viewId:d,viewName:"blog"};return h.addConfigurations=function(){var o=t.proxies,i=document.location.href,e="/proxy/proxy.php";for(var r in o)0===i.indexOf(r)&&(e=o[r]);esri.config.defaults.io.proxyUrl=e,esri.config.defaults.io.corsEnabledServers.push("http://gis-potico.wri.org"),esri.config.defaults.io.corsEnabledServers.push("http://175.41.139.43")},h.init=function(){h.addConfigurations();return p?(n.switchToView(c),void 0):(p=!0,u.showLoader("stackContainer","blog-blocker"),require(["dojo/text!views/blog/blog.html"],function(i){var e=h.loadFeed(esri.config.defaults.io.proxyUrl);e.then(function(e){var r=JSON.parse(e);h.addPosts(r),o.byId(d).innerHTML=i,n.switchToView(c),l.applyBindings(d),u.hideLoader("blog-blocker")},function(){console.log("There was an error in binding")})}),void 0)},h.loadFeed=function(o){var i=new s;return require(["views/blog/BlogLoader"],function(e){var r=e.load_feed(o);r.then(function(o){i.resolve(o)},function(){console.dir("error")})}),i.promise},h.addPosts=function(o){console.log(o),o.articles.forEach(function(o){o.getAuthors=function(){var o=this.author.split(","),i=[],e=!1;return o[o.length-2]=o[o.length-2]+o[o.length-1],o.pop(),a.forEach(o,function(r,t){try{if(!e)if(null!==r.match("by")&&null===r.match("-")){var n=r.split("by");i.push("by"),i.push(n[1].trim())}else if(null!==r.match("by")&&null!==r.match("-")){var l=r.split("-");i.push("by"),i.push(l[0].split("by")[1].trim()),i.push(l[1].trim()),e=!0}else if(null!==r.match("and")&&null!==r.match("-")){var s=r.split("and");a.forEach(s,function(o){if(null===o.match("-"))i.push(o.trim());else{var r=o.split("-");i.push("and"),i.push(r[0].trim()),i.push(r[1].trim()),e=!0}})}else if(null===r.match("and")&&null!==r.match("-")&&t===o.length-1){var u=o[o.length-2].split("and"),h=r.split("-");i.pop(),i.pop(),i.pop(),i.push(u[0].trim()),i.push("and"),i.push(u[1].trim()+", "+h[0].trim()),i.push(h[1].trim()),e=!0}else if(null!==r.match("and")){var s=r.split("and");i.push(s[0].trim()),i.push("and"),i.push(s[1].trim())}else if(null!==r.match("-")){var p=r.split("-");i.push(p[0].trim()),i.push(p[1].trim()),e=!0}else i.push(r.trim())}catch(d){console.log(d)}}),i}}),l.vm.blogPost.push(o)},h});